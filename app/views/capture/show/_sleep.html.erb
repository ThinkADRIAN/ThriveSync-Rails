<% if @user == nil %>
    <% user = current_user %>
<% else %>
    <% user = @user %>
<% end %>

<% if $capture_date == nil %>
    <% $capture_date = Time.zone.now.to_date %>
<% end %>

<% @capture_sleeps = Sleep.where(user_id: user.id, finish_time: ($capture_date.at_beginning_of_day.in_time_zone..$capture_date.end_of_day.in_time_zone)) %>

<br>

<div class="scroller">
  <% if !@capture_sleeps.nil? %>
      <% @capture_sleeps.each do |sleep| %>
          <div class="capture_show">
            <p>
              <strong><%= t "capture.show.sleep.start" %></strong>
              <br>
            <center>
              <%= sleep.start_time.strftime("%l:%M %p - %A, %b %d, %Y") %>
            </center>
            </p>
            <p>
              <strong><%= t "capture.show.sleep.finish" %></strong>
              <br>
            <center>
              <%= sleep.finish_time.strftime("%l:%M %p - %A, %b %d, %Y") %>
            </center>
            </p>
            <p>
              <strong><%= t "capture.show.sleep.quality" %></strong>
              <br>
            <center>
              <% if sleep.quality == 1 %>
                  <%= t "repeat.categories.broken" %>
              <% elsif sleep.quality == 2 %>
                  <%= t "repeat.categories.light" %>
              <% elsif sleep.quality == 3 %>
                  <%= t "repeat.categories.normal" %>
              <% elsif sleep.quality == 4 %>
                  <%= t "repeat.categories.deep" %>
              <% end %>
            </center>
            </p>

            <br>

            <div class="slider-timestamp">
              <center>
                <%= sleep.created_at.strftime("%I:%M %p") %><br>
                <%= link_to t("menu.edit"), edit_sleep_path(id: sleep.id), remote: true, class: "btn btn-sm" %><br>
              </center>
            </div>
          </div>
      <% end %>
  <% end %>
  <% if @capture_sleeps.nil? || @capture_sleeps.count < MAX_SLEEP_ENTRIES %>
      <div class="capture_button">
        <center>
          <br>
          <%= link_to t("capture.show.sleep.add"), new_sleep_path, remote: true, class: "btn btn-primary btn-lg" %><br>
          <br>
        </center>
      </div>
  <% end %>
</div>


<script type="text/javascript">
    $('.scroller').slick({
        dots: true
    })
</script>