<div class="container">
  <br>

  <div class="col-md-12">
    <% if (current_user.is? :user) || (current_user.is? :client) %>
        <%= link_to t("friendships.index.addpro"), new_connection_path, class: "btn btn-primary" %>
    <% elsif current_user.is? :pro %>
        <%= link_to t("friendships.index.addpat"), new_connection_path, class: "btn btn-primary" %>
    <% end %>
    <br><br>
  </div>
  <div class="col-md-12">
    <% if !@pending_friends.empty? %>
        <div class="panel panel-info">
          <div class="panel-heading">
            <% if current_user.is? :user %>
                <h3 class="panel-title"><%= t "friendships.index.pendingc" %></h3>
                <% pending_connections = @pending_providers %>
            <% elsif current_user.is? :pro %>
                <h3 class="panel-title"><%= t "friendships.index.pendingp" %></h3>
                <% pending_connections = @pending_patients %>
            <% end %>
          </div>
          <div class="panel-body">
            <% for user in pending_connections %>
                <% if (user.is? :pro) || (user.is? :user) %>
                    <div class="col-md-4">
                      <h3><%= user.first_name + " " + user.last_name %></h3>

                      <p><%= user.email %></p>
                    </div>
                    <div class="col-md-8">
                      <h3></h3>
                      <%= link_to t("menu.cancel"), connection_path(user), :method => "delete", data: {confirm: t("repeat.friendship.surecancel")}, class: "btn-danger btn-xs" %>
                    </div>
                    <div class="col-md-12">
                      <hr>
                    </div>
                <% end %>
            <% end %>
          </div>
        </div>
    <% end %>
    <% if !@requested_friends.empty? %>
        <div class="panel panel-warning">
          <div class="panel-heading">
            <% if current_user.is? :user %>
                <h3 class="panel-title"><%= t "friendships.index.requestpro" %></h3>
                <% requested_connections = @requested_providers %>
            <% elsif current_user.is? :pro %>
                <h3 class="panel-title"><%= t "friendships.index.requestpat" %></h3>
                <% requested_connections = @requested_patients %>
            <% end %>
          </div>
          <div class="panel-body">
            <% for user in requested_connections %>
                <% if (user.is? :pro) || (user.is? :user) %>
                    <div class="col-md-4">
                      <h3><%= user.first_name + " " + user.last_name %></h3>

                      <p><%= user.email %></p>
                    </div>
                    <div class="col-md-8">
                      <h3></h3>
                      <%= link_to t("repeat.accept"), connection_path(user), :method => "put", class: "btn-primary btn-xs" %>
                      <%= link_to t("repeat.reject"), connection_path(user), :method => "delete", data: {confirm: t("repeat.friendship.surereject")}, class: "btn-danger btn-xs" %>
                    </div>
                    <div class="col-md-12">
                      <hr>
                    </div>
                <% end %>
            <% end %>
          </div>
        </div>
    <% end %>

    <div class="panel panel-default">
      <div class="panel-heading">
        <% if current_user.is? :user %>
            <h3 class="panel-title"><%= t "friendships.index.procon" %></h3>
            <% connections = @providers %>
        <% elsif current_user.is? :pro %>
            <h3 class="panel-title"><%= t "friendships.index.patcon" %></h3>
            <% connections = @patients %>
        <% end %>
      </div>
      <div class="panel-body">
        <% if !@friends.empty? #if @friends != nil  %>
            <% for user in connections %>
                <% if ((user.is? :pro) && (user.clients.include? current_user.id)) || ((user.is? :user) && (current_user.clients.include? user.id)) %>
                    <div class="col-md-4">
                      <h3><%= user.first_name + " " + user.last_name %></h3>

                      <p><%= user.email %></p>
                    </div>
                    <div class="col-md-8">
                      <h3></h3>
                      <%= link_to t("repeat.friendship.dc"), connection_path(user), :method => "delete", data: {confirm: t("repeat.friendship.suredc")}, class: "btn-danger btn-xs" %>
                    </div>
                    <div class="col-md-12">
                      <hr>
                    </div>
                <% end %>
            <% end %>
        <% else %>
            <div>
              <h3><% t "repeat.friendship.nocon" %></h3>
            </div>
        <% end %>
      </div>
    </div>
  </div>
</div>